{% extends 'base.html' %}

{% load static %}

{% block title %}Home - Restaurant Overview{% endblock %}

{% block content %}
  <link rel="stylesheet" type="text/css" href="{% static 'css/home.css' %}">
<div class="container">
    <h1 style="text-align: center; font-size: 32px; margin-bottom: 20px; color: #333;">Restaurant Overview</h1>

  <label>
    <input type="text" class="search-bar" placeholder="Search positions..." onkeyup="filterTable()">
  </label>

  <form method="GET" style="display: flex; gap: 10px; align-items: center; background: #f8f9fa; padding: 15px; border-radius: 10px; box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);">
        <label for="category_id" style="font-size: 18px; font-weight: bold;">Filter by Category:</label>
        <select name="category_id" id="category_id" class="filter" style="padding: 8px; font-size: 16px; border-radius: 5px; border: 1px solid #ccc;">
            <option value="">All Categories</option>
            {% for position in positions %}
                <option value="{{ position.id }}" {% if position.id|stringformat:"s" == selected_category %}selected{% endif %}>
                    {{ position.position_name }}
                </option>
            {% endfor %}
        </select>

        <label for="sort" style="font-size: 18px; font-weight: bold;">Sort by Price:</label>
        <select name="sort" id="sort" class="filter" style="padding: 8px; font-size: 16px; border-radius: 5px; border: 1px solid #ccc;">
            <option value="asc">Low to High</option>
            <option value="desc">High to Low</option>
        </select>
    </form>

    <h2 style="font-size: 26px; margin-top: 20px; color: #333;">Positions</h2>
    <table id="positionsTable">
        <tr>
            <th>Name</th>
        </tr>
        {% for position in positions %}
        <tr>
            <td>{{ position.position_name }}</td>
        </tr>
        {% empty %}
        <tr>
            <td style="text-align: center; font-style: italic;">No positions available</td>
        </tr>
        {% endfor %}
    </table>

    <h2 style="font-size: 26px; margin-top: 30px; color: #333;">Position List</h2>
    <table id="positionListTable">
        <tr>
            <th>Name</th>
            <th>Description</th>
            <th style="text-align: right;">Price</th>
            <th>Category</th>
            <th>Chef</th>
        </tr>
        {% for item in position_list %}
        <tr>
            <td>{{ item.position_name }}</td>
            <td>{{ item.description }}</td>
            <td style="text-align: right;">${{ item.price }}</td>
            <td>{{ item.category.position_name }}</td>
            <td>{{ item.chef }}</td>
        </tr>
        {% empty %}
        <tr>
            <td colspan="5" style="text-align: center; font-style: italic;">No position list available</td>
        </tr>
        {% endfor %}
    </table>
</div>

<script>
    document.querySelectorAll('.filter').forEach(filter => {
        filter.addEventListener('change', () => {
            document.forms[0].submit();
        });
    });

    function filterTable() {
        let input = document.querySelector('.search-bar').value.toLowerCase();
        let rows = document.querySelectorAll('#positionListTable tr:not(:first-child)');
        rows.forEach(row => {
            let text = row.innerText.toLowerCase();
            row.style.display = text.includes(input) ? '' : 'none';
        });
    }
</script>
{% endblock %}
